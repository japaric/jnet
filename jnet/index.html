<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `jnet` crate."><meta name="keywords" content="rust, rustlang, rust-lang, jnet"><title>jnet - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../jnet/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><p class='location'>Crate jnet</p><div class="sidebar-elems"><a id='all-types' href='all.html'><p>See all jnet's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#enums">Enums</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'jnet', ty: 'mod', relpath: '../'};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/jnet/lib.rs.html#1-138' title='goto source code'>[src]</a></span><span class='in-band'>Crate <a class="mod" href=''>jnet</a></span></h1><div class='docblock'><p>JNeT: japaric's network thingies</p>
<p>There's no IO stuff in this crate. If you are looking for sockets and the like check out the
<a href="https://crates.io/crates/smoltcp"><code>smoltcp</code></a> crate.</p>
<p>This crate mainly contains an API to work with frames and packets in <code>no_std</code> context.</p>
<p>It doesn't provide you any real <em>parser</em> though; it simply provides an API to mutate or access
the header and the payload of a frame / packet <em>in place</em>. This approach is the same as the one
used in <code>smoltcp</code>. The difference is that the API of this crate uses type state to (a) avoid
foot guns like sending an IPv4 packet with an invalid header checksum, and to (b) provide
specialized APIs when the packet type, e.g. ICMP EchoRequest, is known.</p>
<p>If type state is not your cup of tea check out <code>smoltcp</code>'s <a href="https://docs.rs/smoltcp/0.4.0/smoltcp/wire/index.html">wire module</a>; do note that, as of
v0.4.0, <code>smoltcp</code> doesn't provide an API to work with CoAP messages whereas this crate does.</p>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<ul>
<li>Parsing an ARP packet</li>
</ul>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">jnet</span>::{<span class="ident">arp</span>, <span class="ident">ether</span>};

<span class="kw">let</span> <span class="ident">bytes</span> <span class="op">=</span> <span class="kw-2">&amp;</span>[
    <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="comment">// eth: destination</span>
    <span class="number">120</span>, <span class="number">68</span>, <span class="number">118</span>, <span class="number">217</span>, <span class="number">106</span>, <span class="number">124</span>, <span class="comment">// eth: source</span>
    <span class="number">8</span>, <span class="number">6</span>, <span class="comment">// eth: type</span>
    <span class="number">0</span>, <span class="number">1</span>, <span class="comment">// arp: HTYPE = Ethernet</span>
    <span class="number">8</span>, <span class="number">0</span>, <span class="comment">// arp: PTYPE = IPv4</span>
    <span class="number">6</span>, <span class="comment">// arp: HLEN</span>
    <span class="number">4</span>, <span class="comment">// arp: PLEN</span>
    <span class="number">0</span>, <span class="number">2</span>, <span class="comment">// arp: OPER = Reply</span>
    <span class="number">120</span>, <span class="number">68</span>, <span class="number">118</span>, <span class="number">217</span>, <span class="number">106</span>, <span class="number">124</span>, <span class="comment">// arp: SHA</span>
    <span class="number">192</span>, <span class="number">168</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="comment">// arp: SPA</span>
    <span class="number">32</span>, <span class="number">24</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="comment">// arp: THA</span>
    <span class="number">192</span>, <span class="number">168</span>, <span class="number">1</span>, <span class="number">33</span>, <span class="comment">// arp: TPA</span>
    <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="comment">// eth: padding</span>
];

<span class="kw">let</span> <span class="ident">eth</span> <span class="op">=</span> <span class="ident">ether</span>::<span class="ident">Frame</span>::<span class="ident">parse</span>(<span class="kw-2">&amp;</span><span class="ident">bytes</span>[..]).<span class="ident">unwrap</span>();
<span class="kw">let</span> <span class="ident">arp</span> <span class="op">=</span> <span class="ident">arp</span>::<span class="ident">Packet</span>::<span class="ident">parse</span>(<span class="ident">eth</span>.<span class="ident">payload</span>()).<span class="ident">unwrap</span>();

<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">arp</span>.<span class="ident">get_htype</span>(), <span class="ident">arp</span>::<span class="ident">HardwareType</span>::<span class="ident">Ethernet</span>);
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">arp</span>.<span class="ident">get_ptype</span>(), <span class="ident">ether</span>::<span class="ident">Type</span>::<span class="ident">Ipv4</span>);
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">arp</span>.<span class="ident">get_oper</span>(), <span class="ident">arp</span>::<span class="ident">Operation</span>::<span class="ident">Reply</span>);</pre></div>
<ul>
<li>Constructing a CoAP message</li>
</ul>
<p>The general principle to building frames / packets / messages is to start with an (slightly)
oversized buffer and then proceed to shrink it to the right length.</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">jnet</span>::{<span class="ident">coap</span>, <span class="ident">ether</span>, <span class="ident">ipv4</span>, <span class="ident">mac</span>, <span class="ident">udp</span>};

<span class="kw">const</span> <span class="ident">MAC_SRC</span>: <span class="ident">mac</span>::<span class="ident">Addr</span> <span class="op">=</span> <span class="ident">mac</span>::<span class="ident">Addr</span>([<span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]);
<span class="kw">const</span> <span class="ident">MAC_DST</span>: <span class="ident">mac</span>::<span class="ident">Addr</span> <span class="op">=</span> <span class="ident">mac</span>::<span class="ident">Addr</span>([<span class="number">0x20</span>, <span class="number">0x18</span>, <span class="number">0x03</span>, <span class="number">0x13</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]);

<span class="kw">const</span> <span class="ident">IP_SRC</span>: <span class="ident">ipv4</span>::<span class="ident">Addr</span> <span class="op">=</span> <span class="ident">ipv4</span>::<span class="ident">Addr</span>([<span class="number">192</span>, <span class="number">168</span>, <span class="number">1</span>, <span class="number">11</span>]);
<span class="kw">const</span> <span class="ident">IP_DST</span>: <span class="ident">ipv4</span>::<span class="ident">Addr</span> <span class="op">=</span> <span class="ident">ipv4</span>::<span class="ident">Addr</span>([<span class="number">192</span>, <span class="number">168</span>, <span class="number">1</span>, <span class="number">33</span>]);

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">bytes</span> <span class="op">=</span> [<span class="number">0</span>; <span class="number">60</span>];
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">buf</span> <span class="op">=</span> <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">bytes</span>[..];

<span class="comment">// clean slate Ethernet frame with a total length of 60 bytes</span>
<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">eth</span> <span class="op">=</span> <span class="ident">ether</span>::<span class="ident">Frame</span>::<span class="ident">new</span>(<span class="ident">buf</span>);
<span class="ident">eth</span>.<span class="ident">set_destination</span>(<span class="ident">MAC_DST</span>);
<span class="ident">eth</span>.<span class="ident">set_source</span>(<span class="ident">MAC_SRC</span>);

<span class="ident">eth</span>.<span class="ident">ipv4</span>(<span class="op">|</span><span class="ident">ip</span><span class="op">|</span> {
    <span class="ident">ip</span>.<span class="ident">set_source</span>(<span class="ident">IP_SRC</span>);
    <span class="ident">ip</span>.<span class="ident">set_destination</span>(<span class="ident">IP_DST</span>);
    <span class="ident">ip</span>.<span class="ident">udp</span>(<span class="op">|</span><span class="ident">udp</span><span class="op">|</span> {
        <span class="ident">udp</span>.<span class="ident">set_destination</span>(<span class="ident">coap</span>::<span class="ident">PORT</span>);
        <span class="ident">udp</span>.<span class="ident">coap</span>(<span class="number">0</span>, <span class="op">|</span><span class="kw-2">mut</span> <span class="ident">coap</span><span class="op">|</span> {
            <span class="ident">coap</span>.<span class="ident">set_type</span>(<span class="ident">coap</span>::<span class="ident">Type</span>::<span class="ident">Confirmable</span>);
            <span class="ident">coap</span>.<span class="ident">set_code</span>(<span class="ident">coap</span>::<span class="ident">Method</span>::<span class="ident">Put</span>);
            <span class="ident">coap</span>.<span class="ident">add_option</span>(<span class="ident">coap</span>::<span class="ident">OptionNumber</span>::<span class="ident">UriPath</span>, <span class="string">b&quot;led&quot;</span>);
            <span class="ident">coap</span>.<span class="ident">set_payload</span>(<span class="string">b&quot;on&quot;</span>)
        })
    });
});

<span class="comment">// At this point the Ethernet frame has shrunk to the size of its contents</span>
<span class="comment">// The excess memory is inaccessible</span>
<span class="macro">assert_eq</span><span class="macro">!</span>(<span class="ident">eth</span>.<span class="ident">len</span>(), <span class="number">53</span>);</pre></div>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table><tr class='module-item'><td><a class="mod" href="arp/index.html" title='jnet::arp mod'>arp</a></td><td class='docblock-short'><p>ARP: Address Resolution Protocol</p>
</td></tr><tr class='module-item'><td><a class="mod" href="coap/index.html" title='jnet::coap mod'>coap</a></td><td class='docblock-short'><p>CoAP: Constrained Application Protocol</p>
</td></tr><tr class='module-item'><td><a class="mod" href="ether/index.html" title='jnet::ether mod'>ether</a></td><td class='docblock-short'><p>Ethernet II</p>
</td></tr><tr class='module-item'><td><a class="mod" href="icmp/index.html" title='jnet::icmp mod'>icmp</a></td><td class='docblock-short'><p>ICMP: Internet Control Message Protocol</p>
</td></tr><tr class='module-item'><td><a class="mod" href="icmpv6/index.html" title='jnet::icmpv6 mod'>icmpv6</a></td><td class='docblock-short'><p>ICMPv6: Internet Control Message Protocol for IPv6</p>
</td></tr><tr class='module-item'><td><a class="mod" href="ieee802154/index.html" title='jnet::ieee802154 mod'>ieee802154</a></td><td class='docblock-short'><p>IEEE 802.15.4</p>
</td></tr><tr class='module-item'><td><a class="mod" href="ipv4/index.html" title='jnet::ipv4 mod'>ipv4</a></td><td class='docblock-short'><p>IPv4: Internet Protocol v4</p>
</td></tr><tr class='module-item'><td><a class="mod" href="ipv6/index.html" title='jnet::ipv6 mod'>ipv6</a></td><td class='docblock-short'><p>IPv6: Internet Protocol v6</p>
</td></tr><tr class='module-item'><td><a class="mod" href="mac/index.html" title='jnet::mac mod'>mac</a></td><td class='docblock-short'><p>MAC: Medium Access Control</p>
</td></tr><tr class='module-item'><td><a class="mod" href="sixlowpan/index.html" title='jnet::sixlowpan mod'>sixlowpan</a></td><td class='docblock-short'><p>6LoWPAN: IPv6 over Low-Power Wireless Personal Area Networks</p>
</td></tr><tr class='module-item'><td><a class="mod" href="udp/index.html" title='jnet::udp mod'>udp</a></td><td class='docblock-short'><p>UDP: User Datagram Protocol</p>
</td></tr></table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table><tr class='module-item'><td><a class="enum" href="enum.Invalid.html" title='jnet::Invalid enum'>Invalid</a></td><td class='docblock-short'><p>[Type State] Invalid checksum</p>
</td></tr><tr class='module-item'><td><a class="enum" href="enum.Unknown.html" title='jnet::Unknown enum'>Unknown</a></td><td class='docblock-short'><p>[Type State] Unknown</p>
</td></tr><tr class='module-item'><td><a class="enum" href="enum.Valid.html" title='jnet::Valid enum'>Valid</a></td><td class='docblock-short'><p>[Type State] Valid checksum</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../";window.currentCrate = "jnet";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>